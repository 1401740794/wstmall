function changePage(){var a=window.location.hash.replace("#","");a=a.split("&");if(a[0]=="editPwd"){$("#wst-page1").addClass("wst-page1");$("#wst-page2").show();toEditPwd()}else{if(a[0]=="msgDetails"){$("#wst-page1").addClass("wst-page1");$("#wst-page2").show();getMsgDetails(a[1])}else{$("#wst-page1").show();$("#wst-page2").addClass("wst-page2");$("body").css("background","#EDEDED");setTimeout(function(){$("body").removeClass("ajaxpage-active")},100);setTimeout(function(){$("#wst-page1").removeClass("wst-page1");$("#wst-page2").css("display","none");$("#msgBottom").show()},300)}}}function toEditPwd(){var b=Handlebars.compile($("#editPwd").text());var a=b("");$("#wst-page2").html(a);$("body").addClass("ajaxpage-active");setTimeout(function(){$("#wst-page1").hide();$("#wst-page2").removeClass("wst-page2");$(document).scrollTop(0)},300);b=a=null}function checkInputStatus(){var c=$("#oldPwd").val();var a=$("#newPwd").val();var b=$("#newPwd2").val();if(c!=""&&a!=""&&b!=""){$("#pwd-confirm").addClass("active")}else{$("#pwd-confirm").removeClass("active")}}function submitPwd(){if($("#pwd-confirm").attr("class").indexOf("active")>-1){var c=$("#oldPwd").val();var a=$("#newPwd").val();var b=$("#newPwd2").val();if(c==""){wstMsg("请输入旧密码","oldPwd");return false}if(a==""){wstMsg("请输入新密码","newPwd");return false}if(a.length<5||a.length>20){wstMsg("密码长度应为5至20位之间","newPwd");return false}if(a!=b){wstMsg("两次输入的新密码不一致","newPwd");return false}$("#pwd-submit").attr("disabled","disabled");$.post(WST.U("WebApp/Users/editPwd"),{oldPwd:c,newPwd:a},function(d){var e=WST.toJson(d);if(e=="1"){wstMsg("密码修改成功");setTimeout(function(){location.href=WST.U("WebApp/Users/index")},2000)}else{if(e=="-1"){wstMsg("您还没登录");$("#pwd-submit").removeAttr("disabled");return false}else{if(e=="-2"){wstMsg("旧密码不正确","oldPwd");$("#pwd-submit").removeAttr("disabled");return false}else{wstMsg("密码修改失败，请重试");$("#pwd-submit").removeAttr("disabled");return false}}}})}}function logout(){$.post(WST.U("WebApp/Users/logout"),{},function(a){var b=WST.toJson(a);if(b=="1"){location.href=WST.U("WebApp/Users/index")}else{wstMsg("退出失败，请重试");return false}})}function getMsgDetails(a){$("#wst-default-loading").modal();$.post(WST.U("WebApp/Messages/getMsgDetails"),{id:a},function(b){var d=WST.toJson(b);var e=Handlebars.compile($("#msgDetails").text());var c=e(d);$("#wst-page2").html(c);$("#wst-default-loading").modal("close");$("body").addClass("ajaxpage-active").css("background","white");setTimeout(function(){$("#wst-page1").hide();$("#wst-page2").removeClass("wst-page2");$("#msgBottom").hide();$(document).scrollTop(0)},300);d=e=c=null})}var msgIdsToDel="";function toDelMsg(){var b=$(".circle-icon.active").length;msgIdsToDel="";for(var a=0;a<b;a++){msgIdsToDel+=$(".circle-icon.active").eq(a).attr("msgId");if(a!=b-1){msgIdsToDel+=","}}if(b==0||msgIdsToDel==""){wstMsg("请选择要删除的消息");return false}wstConfirm("确定要删除选中的消息吗？",delMsg)}function delMsg(){$.post(WST.U("WebApp/Messages/delMsg"),{ids:msgIdsToDel},function(a){var b=WST.toJson(a);if(b.status==1){wstMsg("删除成功");setTimeout(function(){location.href=WST.U("WebApp/Messages/index")},2000)}else{wstMsg("删除失败，请重试")}})}$(document).ready(function(){initFooter("users");$("#user-logout").click(function(){wstConfirm("确定退出登录？",logout)})});