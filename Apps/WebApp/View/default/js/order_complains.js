function changePage(){var a=window.location.hash.replace("#","");a=a.split("&");if(a[0]=="complainDetails"){$("#wst-page1").addClass("wst-page1");$("#wst-page2").show();$("#wst-footer").hide();getComplainDetails(a[1])}else{$("#wst-page1").show();$("#wst-page2").addClass("wst-page2");setTimeout(function(){$("body").removeClass("ajaxpage-active")},100);setTimeout(function(){$("#wst-page1").removeClass("wst-page1");$("#wst-footer").show();$("#wst-page2").css("display","none")},500)}}function getComplainDetails(a){$("#wst-default-loading").modal();$.post(WST.U("WebApp/orderComplains/getComplainDetails"),{complainId:a},function(b){var e=WST.toJson(b);var f=Handlebars.compile($("#complainDetails").text());Handlebars.registerHelper("compare",function(h,i,g){if(h==i){return g.fn(this)}else{return g.inverse(this)}});Handlebars.registerHelper("list",function(g,j){var k="";if(g.length>0){for(var h=0;h<g.length;h++){k+='<img class="complains-img" src="'+WST.ROOT+"/"+g[h]+'">'}}return k});var d={info:e,rooturl:WST.ROOT};var c=f(d);$("#wst-page2").html(c);$("#wst-default-loading").modal("close");$("body").addClass("ajaxpage-active");setTimeout(function(){$("#wst-page1").hide();$("#wst-page2").removeClass("wst-page2");$(document).scrollTop(0)},300);e=f=d=c=null})}function closeUploadArea(){$(".not-upload").show();$("#upload_modal").hide();$("#clip").hide();$("#clipArea").find("img").remove();$("#file").val("");$("#view").css("background-image","");$("#imgData").val("")}function delImg(a){$(a).parent("div.complains-annex").remove();isDisabledButton()}function isDisabledButton(){if($(".complains-annex").length>=5){$("#addImg").attr("disabled","disabled");$("#uploadImg").hide()}else{$("#addImg").removeAttr("disabled");$("#uploadImg").show()}}$(document).ready(function(){initFooter("users");$("#orderInfo").on("open.collapse.amui",function(){$(".order-icon-plus").hide();$(".order-icon-minus").show()}).on("close.collapse.amui",function(){$(".order-icon-plus").show();$(".order-icon-minus").hide()});$("#complainSubmit").click(function(){var c=$('input[name="complainType"]:checked').val();var b=$("#complainContent").val();if(c!=1&&c!=2&&c!=3&&c!=4){wstMsg("请选择投诉类型");return false}if(b==""){wstMsg("请输入投诉内容","complainContent");return false}if($(".complains-annex").length>5){wstMsg("附件数量不能超过5张");return false}var d=new Array();$(".imgSrc").each(function(){d.push($(this).val())});var a=d.join(",");var e={};e.orderId=$("#orderId").val();e.complainType=c;e.complainContent=b;e.complainAnnex=a;$.post(Think.U("WebApp/OrderComplains/saveComplain"),e,function(f){var g=WST.toJson(f);if(g.status==1){wstMsg("您的投诉已提交，请留意信息回复");$("#complainSubmit").attr("disabled","disabled");setTimeout(function(){location.href=WST.U("WebApp/OrderComplains/index")},2000)}else{wstMsg(g.msg);$("#complainSubmit").removeAttr("disabled")}})});$("#uploadImg").on("change",function(){$(".not-upload").hide();$("#clip").show();$("#upload_modal").show()})});