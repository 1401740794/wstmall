function openNickName(){var a={closeViaDimmer:false};$("#wst-nickname-popup").modal(a)}function closeNickName(){$("#wst-nickname-popup").modal("close")}function editNickName(){var a=$("#userName").val();if(a==""){wstMsg("昵称不能为空","userName");return false}$.post(WST.U("WebApp/Users/editUserInfo"),{userName:a},function(b){var c=WST.toJson(b);if(c=="1"){wstMsg("修改昵称成功");$("#nickname").html(a);$("#wst-nickname-popup").modal("close")}else{wstMsg("修改昵称失败，请重试");return false}})}function openUserSex(){var a={closeViaDimmer:false};$("#wst-usersex-popup").modal(a)}function closeUserSex(){$("#wst-usersex-popup").modal("close")}function eidtUserSex(a,b){$(a).children(".usersex-check-area").html('<i class="am-icon-check usersex-check"></i>');$(a).siblings(".usersex").children(".usersex-check-area").html("");$.post(WST.U("WebApp/Users/editUserInfo"),{userSex:b},function(c){var d=WST.toJson(c);if(d=="1"){var e="";if(b==0){e="保密"}else{if(b==1){e="男"}else{if(b==2){e="女"}}}$("#usersex").html(e);wstMsg("修改性别成功");$("#wst-usersex-popup").modal("close")}else{wstMsg("修改性别失败，请重试");return false}})}$(document).ready(function(){initFooter("users");$("#user-logout").click(function(){wstConfirm("确定退出登录？",logout)});$("#sendEmail").click(function(){var a=$("#userEmail").val();var b=$("#verifyCode").val();if(a==""){wstMsg("请输入邮箱","userEmail");return false}if(!WST.isEmail(a)){wstMsg("邮箱地址格式不正确","userEmail");return false}if(b==""){wstMsg("请输入验证码","verifyCode");return false}$(this).attr("disabled","disabled").html("正在处理...");$.post(WST.U("WebApp/Users/sendEmailCodeToBind"),{code:b,userEmail:a},function(c){var d=WST.toJson(c);if(d.status==1){wstMsg("邮件发送成功");var e=120;var f=setInterval(function(){if(e>=1){$("#sendEmail").html("重新发送("+e+")");e--}else{clearInterval(f);$("#sendEmail").removeAttr("disabled").html("发送验证邮件")}},1000);setTimeout(function(){$(".bind-area").show()},1000)}else{if(d.status==-2){wstMsg("验证码不正确","verifyCode");getVerify("verifyImg");$("#sendEmail").removeAttr("disabled").html("发送验证邮件");return false}else{if(d.status==-3){wstMsg("邮箱格式不正确","userEmail");$("#sendEmail").removeAttr("disabled").html("发送验证邮件");return false}else{if(d.status==-4){wstMsg("请勿重复绑定相同的邮箱","userEmail");$("#sendEmail").removeAttr("disabled").html("发送验证邮件");return false}else{wstMsg(d.msg);$("#sendEmail").removeAttr("disabled").html("发送验证邮件");return false}}}}})});$("#bindEmail").click(function(){var a=$("#emailCode").val();if(a==""){wstMsg("请输入邮箱验证码","emailCode");return false}$(this).attr("disabled","disabled").html("正在处理...");$.post(WST.U("WebApp/Users/bindEmail"),{emailCode:a},function(b){var c=WST.toJson(b);if(c.status==1){wstMsg("绑定邮箱成功");setTimeout(function(){location.href=WST.U("WebApp/Users/toUserInfo")},2000)}else{wstMsg(c.msg);$("#bindEmail").removeAttr("disabled").html("绑定邮箱")}})});$("#sendPhone").click(function(){var a=$("#userPhone").val();var b=$("#verifyCode").val();if(a==""){wstMsg("请输入手机号码","userPhone");return false}if(!WST.isPhone(a)){wstMsg("手机号码格式不正确","userPhone");return false}if(b==""){wstMsg("请输入验证码","verifyCode");return false}$(this).attr("disabled","disabled").html("正在处理...");$.post(WST.U("WebApp/Users/sendPhoneCodeToBind"),{code:b,userPhone:a},function(c){var d=WST.toJson(c);if(d.status==1){wstMsg("短信发送成功");var e=120;var f=setInterval(function(){if(e>=1){$("#sendPhone").html("重新发送("+e+")");e--}else{clearInterval(f);$("#sendPhone").removeAttr("disabled").html("发送验证短信")}},1000);setTimeout(function(){$(".bind-area").show()},1000)}else{if(d.status==-2){wstMsg("验证码不正确","verifyCode");getVerify("verifyImg");$("#sendPhone").removeAttr("disabled").html("发送验证短信");return false}else{if(d.status==-3){wstMsg("手机号码格式不正确","userPhone");$("#sendPhone").removeAttr("disabled").html("发送验证短信");return false}else{if(d.status==-4){wstMsg("请勿重复绑定相同的手机号码","userPhone");$("#sendPhone").removeAttr("disabled").html("发送验证短信");return false}else{wstMsg("短信发送失败，请重试");$("#sendPhone").removeAttr("disabled").html("发送验证短信");return false}}}}})});$("#bindPhone").click(function(){var a=$("#phoneCode").val();if(a==""){wstMsg("请输入短信验证码","phoneCode");return false}$(this).attr("disabled","disabled").html("正在处理...");$.post(WST.U("WebApp/Users/bindPhone"),{phoneCode:a},function(b){var c=WST.toJson(b);if(c.status==1){wstMsg("绑定手机号码成功");setTimeout(function(){location.href=WST.U("WebApp/Users/toUserInfo")},2000)}else{wstMsg(c.msg);$("#bindPhone").removeAttr("disabled").html("绑定手机号码")}})})});